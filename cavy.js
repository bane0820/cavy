/*
 Copyright 2013 TriFort.inc
 cavy.js(http://trifort.jp/library/cavy)
 version 0.0.1
 MIT License

 Matrix2D
 Visit http://createjs.com/ for documentation, updates and examples.
 Copyright (c) 2010 gskinner.com, inc.
*/
'use strict';(function(c){c.cavy=c.cavy||{};c.requestAnimationFrame=function(b){return b.requestAnimationFrame||b.webkitRequestAnimationFrame||function(){var a=Date.now();return function(d){var f=Date.now(),e=Math.max(0,16-(f-a));a=f+e;return b.setTimeout(d,e)}}(b)}(c);c.cancelAnimationFrame=c.webkitCancelAnimationFrame||c.webkitCancelRequestAnimationFrame||c.clearTimeout;cavy.retina=!1;cavy.pixelSnap=!1;cavy.autoRetina=!1;cavy.strict=!0;cavy.frameRate=60;cavy.maxSkip=60;cavy.deviceRatio=1;cavy.userAgent=
navigator.userAgent;cavy.bugs={background:["F-06E","L-05E","SC-04E"]};cavy.outOfRendering=!0;cavy.backgroundColor="rgba(255,255,255,0.01)";cavy.isBuggyDevice=function(b){b=cavy.bugs[b];if(!b)return!1;for(var a=b.length;a--;)if(-1!==cavy.userAgent.search(b[a]))return!0;return!1};cavy.isRetina=function(){return 1!==c.devicePixelRatio?!0:!1};cavy.expand=function(){for(var b in this)c[b]=this[b]}})(window);(function(c){c.cavy=c.cavy||{};c=function(){this.__store__=[]};c.prototype={constructor:c,addEventListener:function(b,a){return this.on(b,a)},on:function(b,a){var d=this.__store__[b]||[];d.push(a);this.__store__[b]=d;return this},removeEventListener:function(b,a){return this.off(b,a)},off:function(b,a){if(b)if("function"===typeof a){var d=this.__store__[b];if(d){var f=d.indexOf(a);-1!==f&&(d.splice(f,1),this.__store__[b]=d)}}else delete this.__store__[b];else this.__store__=[];return this},hasEvent:function(b){return this.__store__[b]?
!0:!1},dispatchEvent:function(b,a,d){return this.trigger(b,a,d)},trigger:function(b,a,d){var f=this.__store__[b]||null;if(f){d=d||this;for(var e=Array.prototype.slice.apply(arguments,[1]),c=0,h=f.length;c<h;c++)f[c].apply(d,e)}return this}};cavy.EventDispatcher=c})(window);(function(c){c.cavy=c.cavy||{};var b=function(a,d,b){cavy.EventDispatcher.apply(this);this.data=a;this.keys=[];this.result=[];this.leaveCount=this.length=this.loadedCount=this.index=0;"function"===typeof d?this.callback=d:"function"===typeof b&&(this.callback=b);this.maxConnection="number"===typeof d?b:"number"===typeof b?b:5;var e=this;this.loadedHandler=function(a){e.loaded(a.target)};this.errorHandler=function(a){e._error(a)};c.setTimeout(function(){e.init()},0)};b.prototype=Object.create(cavy.EventDispatcher.prototype);
b.prototype.constructor=b;b.prototype.init=function(){var a=this.maxConnection;this.keys=Object.keys(this.data);this.length=this.keys.length;a>this.length&&(a=this.length);this.leaveCount=this.length-a;this.index=a;for(var d=0;d<a;d++)this.load(d)};b.prototype.loaded=function(a){++this.loadedCount;this.dispatchEvent("step",a);a.removeEventListener("load",this.loadedHandler);a.removeEventListener("error",this.errorHandler);this.result[a.id]=a;this.loadedCount===this.length?(this.dispatchEvent("complete",
this.result),"function"===typeof this.callback&&this.callback(this.result)):0!==this.leaveCount&&(this.leaveCount--,this.load(this.index++))};b.prototype.load=function(a){var d=new Image;d.id=this.keys[a];d.addEventListener("load",this.loadedHandler);d.addEventListener("error",this.errorHandler);d.src=this.data[this.keys[a]];d.complete&&this.loaded(d)};b.prototype._error=function(a){this.trigger("error",a);return this};b.prototype.get=function(a){return this.result[a]};b.prototype.error=function(a){var d=
function(){this.removeEventListener("error",d);a.apply(this,[arguments])};this.addEventListener("error",d);return this};b.prototype.complete=function(a){var d=function(){this.removeEventListener("complete",d);a.apply(this,[arguments])};this.addEventListener("complete",d);return this};b.prototype.destroy=function(){delete this.result;delete this.data;this.result=[]};cavy.Preload=b})(window);(function(c){c.cavy=c.cavy||{};var b=function(a,d,b,e,c,h,k){this.a=1;this.c=this.b=0;this.d=1;this.f=this.e=0;this.opacity=1;this.initialize(a,d,b,e,c,h,k)};b.identity=null;b.DEG_TO_RAD=Math.PI/180;b.prototype={constructor:b,a:1,b:0,c:0,d:1,e:0,f:0,opacity:1,initialize:function(a,d,b,e,c,h,k){null!=a&&(this.a=a);this.b=d||0;this.c=b||0;null!=e&&(this.d=e);this.e=c||0;this.f=h||0;this.opacity=isNaN(k)?1:k;return this},prepend:function(a,d,b,e,c,h){var k=this.e;if(1!==a||0!==d||0!==b||1!==e){var m=
this.a,n=this.c;this.a=m*a+this.b*b;this.b=m*d+this.b*e;this.c=n*a+this.d*b;this.d=n*d+this.d*e}this.e=k*a+this.f*b+c;this.f=k*d+this.f*e+h;return this},append:function(a,d,b,e,c,h){var k=this.a,m=this.b,n=this.c,l=this.d;this.a=a*k+d*n;this.b=a*m+d*l;this.c=b*k+e*n;this.d=b*m+e*l;this.e=c*k+h*n+this.e;this.f=c*m+h*l+this.f;return this},prependMatrix:function(a){this.prepend(a.a,a.b,a.c,a.d,a.e,a.f);return this},appendMatrix:function(a){this.append(a.a,a.b,a.c,a.d,a.e,a.f);return this},prependTransform:function(a,
d,f,e,c,h,k,m,n){var l=1,p=0;c%360&&(c*=b.DEG_TO_RAD,l=Math.cos(c),p=Math.sin(c));if(m||n)this.e-=m,this.f-=n;h||k?(h*=b.DEG_TO_RAD,k*=b.DEG_TO_RAD,this.prepend(l*f,p*f,-p*e,l*e,0,0),this.prepend(Math.cos(k),Math.sin(k),-Math.sin(h),Math.cos(h),a,d)):this.prepend(l*f,p*f,-p*e,l*e,a,d);return this},appendTransform:function(a,d,f,e,c,h,k,m,n){var l=1,p=0;c%360&&(c*=b.DEG_TO_RAD,l=Math.cos(c),p=Math.sin(c));h||k?(h*=b.DEG_TO_RAD,k*=b.DEG_TO_RAD,this.append(Math.cos(k),Math.sin(k),-Math.sin(h),Math.cos(h),
a,d),this.append(l*f,p*f,-p*e,l*e,0,0)):this.append(l*f,p*f,-p*e,l*e,a,d);if(m||n)this.e-=m*this.a+n*this.c,this.f-=m*this.b+n*this.d;return this},rotate:function(a){a*=b.DEG_TO_RAD;var d=Math.cos(a);a=Math.sin(a);var f=this.a,c=this.c,g=this.e;this.a=f*d-this.b*a;this.b=f*a+this.b*d;this.c=c*d-this.d*a;this.d=c*a+this.d*d;this.e=g*d-this.f*a;this.f=g*a+this.f*d;return this},skew:function(a,d){a*=b.DEG_TO_RAD;d*=b.DEG_TO_RAD;this.append(Math.cos(d),Math.sin(d),-Math.sin(a),Math.cos(a),0,0);return this},
scale:function(a,d){this.a*=a;this.d*=d;this.c*=a;this.b*=d;this.e*=a;this.f*=d;return this},translate:function(a,d){this.e+=a;this.f+=d;return this},identity:function(){this.a=this.d=this.opacity=1;this.b=this.c=this.e=this.f=0;return this},invert:function(){var a=this.a,d=this.b,b=this.c,c=this.d,g=this.e,h=a*c-d*b;this.a=c/h;this.b=-d/h;this.c=-b/h;this.d=a/h;this.e=(b*this.f-c*g)/h;this.f=-(a*this.f-d*g)/h;return this},isIdentity:function(){return 0===this.e&&0===this.f&&1===this.a&&0===this.b&&
0===this.c&&1===this.d},decompose:function(a){null==a&&(a={});a.x=this.e;a.y=this.f;a.scaleX=Math.sqrt(this.a*this.a+this.b*this.b);a.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var d=Math.atan2(-this.c,this.d),f=Math.atan2(this.b,this.a);d==f?(a.rotation=f/b.DEG_TO_RAD,0>this.a&&0<=this.d&&(a.rotation+=0>=a.rotation?180:-180),a.skewX=a.skewY=0):(a.skewX=d/b.DEG_TO_RAD,a.skewY=f/b.DEG_TO_RAD);return a},clone:function(){return new b(this.a,this.b,this.c,this.d,this.e,this.f,this.opacity)},toString:function(){return"matrix("+
this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"},toString3D:function(){return"matrix3d("+this.a+","+this.b+",0,0,"+this.c+","+this.d+",0,0,0,0,1,0,"+this.e+","+this.f+",0,1)"}};b.identity=new b(1,0,0,1,0,0);cavy.Matrix2D=b})(window);(function(c){c.cavy=c.cavy||{};var b=function(){this.isTick=!1;this.repeats=[];this.time=0;var a=this;this._loopHandler=function(){a.update()}};b.prototype={constructor:b,update:function(){for(var a=Date.now(),b=this.repeats.length,e=null,g=this.repeats.slice(0);b--;)(e=g[b])&&a-e.time>=e.delay&&(isNaN(e.count)||(--e.count,0===e.count&&this.repeats.splice(b,1),e.cacheCount-=e.count),e.callback(a-e.time,e.count),e.time=a);this.time=a;this.timer=c.requestAnimationFrame(this._loopHandler)},repeat:function(d,
b,c){d=new a(this.time,d,b,c);this.repeats.push(d);this.play();return d},delay:function(d,b){var c=new a(this.time,d,Math.floor(b),1);this.repeats.push(c);this.play();return c},play:function(){this.isTick||(this.isTick=!0,this.timer=c.requestAnimationFrame(this._loopHandler))},stop:function(a){a=this.repeats.indexOf(a);-1!==a&&this.repeats.splice(a,1);0===this.repeats.length&&(c.cancelAnimationFrame(this.timer),this.isTick=!1)}};cavy.Timer=new b;var a=function(a,b,c,g){this.time=a||0;this.callback=
b||function(){};this.delay=c||0;this.count=g||NaN;this.cacheCount=g||0};a.prototype={stop:function(){cavy.Timer.stop(this)}};cavy.TimerObject=a})(window);(function(c){c.cavy=c.cavy||{};var b=function(a){this.queue=a?Array(a):[];this.labels={};this.frame=0;this.timer=null;this.passedTime=this.time=0;var d=this;this._enterframeHandler=function(a){d._tick();d.frame++};cavy.EventDispatcher.apply(this)};b.prototype=Object.create(cavy.EventDispatcher.prototype);b.prototype.constructor=b;b.prototype.SECOND=1E3;b.prototype.add=function(a,d){if("string"===typeof a){var b=this.labels[a];if(isNaN(b)){c.console.error("Not found label ["+a+"]");return}a=b}a=Math.round(a/
(this.SECOND/cavy.frameRate));"object"===typeof this.queue[a]?this.queue[a].push(d):this.queue[a]=[d];return this};b.prototype.addLabel=function(a,d,b){this.labels[d]=a;b&&this.add(a,b)};b.prototype.removeLabel=function(a){delete this.labels[a]};b.prototype.remove=function(a,d){var b=this.queue[a];if(b){var c=b.indexOf(d);-1!==c&&b.splice(c,1)}return this};b.prototype.play=function(){this.stop();this.time=Date.now();this.timer=cavy.Timer.repeat(this._enterframeHandler);return this};b.prototype.stop=
function(){cavy.Timer.stop(this.timer);return this};b.prototype.goToAndPlay=function(a){if("string"===typeof a){var d=this.labels[a];if(isNaN(d)){c.console.error("Not found label ["+a+"]");return}a=d}this.frame=Math.round(a/(this.SECOND/cavy.frameRate));this.passedTime=Math.floor(this.frame*(this.SECOND/cavy.frameRate));this._tick();this.play()};b.prototype.goToAndStop=function(a){if("string"===typeof a){var d=this.labels[a];if(isNaN(d)){c.console.error("Not found label ["+a+"]");return}a=d}this.frame=
Math.round(a/(b.SECOND/cavy.Tween.frameRate));this.passedTime=Math.floor(this.frame*(this.SECOND/cavy.frameRate));this._tick();this.stop()};b.prototype.reset=function(){this.frame=0;return this};b.prototype._tick=function(){var a=Date.now();this.passedTime+=a-this.time;this.time=a;a=Math.floor(this.passedTime/(1E3/cavy.frameRate));a-this.frame>cavy.maxSkip&&(a=this.frame+cavy.maxSkip);var d=[this.frame,a];this.frame=a;for(var b=d[0];b<=d[1]&&this.frame===a;b++){var c=this.queue[b];if(c&&0!==c.length)for(var g=
c.length;g--;)c[g].apply(this,[this.frame])}this.frame>this.queue.length&&(this.stop(),this.dispatchEvent("complete"))};cavy.Timeline=b})(window);(function(c){c.cavy=c.cavy||{};var b=function(){var a=this.create;a.create=this.create;a.remove=this.remove;return a};b.prototype={constructor:b,create:function(d,b){return new a(d,b||!1)},remove:function(a){a.destroy()}};b.duration=1E3;b.easing="easeOutQuad";b.Easing={linear:function(a,d,b,c){return b*a/c+d},easeInQuad:function(a,d,b,c){return b*(a/=c)*a+d},easeOutQuad:function(a,d,b,c){return-b*(a/=c)*(a-2)+d},easeInOutQuad:function(a,d,b,c){return 1>(a/=c/2)?b/2*a*a+d:-b/2*(--a*(a-2)-1)+d},easeInCubic:function(a,
d,b,c){return b*(a/=c)*a*a+d},easeOutCubic:function(a,d,b,c){return b*((a=a/c-1)*a*a+1)+d},easeInOutCubic:function(a,d,b,c){return 1>(a/=c/2)?b/2*a*a*a+d:b/2*((a-=2)*a*a+2)+d},easeInQuart:function(a,d,b,c){return b*(a/=c)*a*a*a+d},easeOutQuart:function(a,d,b,c){return-b*((a=a/c-1)*a*a*a-1)+d},easeInOutQuart:function(a,d,b,c){return 1>(a/=c/2)?b/2*a*a*a*a+d:-b/2*((a-=2)*a*a*a-2)+d},easeInQuint:function(a,d,b,c){return b*(a/=c)*a*a*a*a+d},easeOutQuint:function(a,d,b,c){return b*((a=a/c-1)*a*a*a*a+1)+
d},easeInOutQuint:function(a,d,b,c){return 1>(a/=c/2)?b/2*a*a*a*a*a+d:b/2*((a-=2)*a*a*a*a+2)+d},easeInSine:function(a,d,b,c){return-b*Math.cos(a/c*(Math.PI/2))+b+d},easeOutSine:function(a,d,b,c){return b*Math.sin(a/c*(Math.PI/2))+d},easeInOutSine:function(a,d,b,c){return-b/2*(Math.cos(Math.PI*a/c)-1)+d},easeInExpo:function(a,d,b,c){return 0==a?d:b*Math.pow(2,10*(a/c-1))+d},easeOutExpo:function(a,d,b,c){return a==c?d+b:b*(-Math.pow(2,-10*a/c)+1)+d},easeInOutExpo:function(a,d,b,c){return 0==a?d:a==
c?d+b:1>(a/=c/2)?b/2*Math.pow(2,10*(a-1))+d:b/2*(-Math.pow(2,-10*--a)+2)+d},easeInCirc:function(a,d,b,c){return-b*(Math.sqrt(1-(a/=c)*a)-1)+d},easeOutCirc:function(a,d,b,c){return b*Math.sqrt(1-(a=a/c-1)*a)+d},easeInOutCirc:function(a,d,b,c){return 1>(a/=c/2)?-b/2*(Math.sqrt(1-a*a)-1)+d:b/2*(Math.sqrt(1-(a-=2)*a)+1)+d},easeInElastic:function(a,d,b,c){var f=1.70158,e=0,g=b;if(0==a)return d;if(1==(a/=c))return d+b;e||(e=0.3*c);g<Math.abs(b)?(g=b,f=e/4):f=e/(2*Math.PI)*Math.asin(b/g);return-(g*Math.pow(2,
10*(a-=1))*Math.sin((a*c-f)*2*Math.PI/e))+d},easeOutElastic:function(a,d,b,c){var f=1.70158,e=0,g=b;if(0==a)return d;if(1==(a/=c))return d+b;e||(e=0.3*c);g<Math.abs(b)?(g=b,f=e/4):f=e/(2*Math.PI)*Math.asin(b/g);return g*Math.pow(2,-10*a)*Math.sin((a*c-f)*2*Math.PI/e)+b+d},easeInOutElastic:function(a,d,b,c){var f=1.70158,e=0,g=b;if(0==a)return d;if(2==(a/=c/2))return d+b;e||(e=c*0.3*1.5);g<Math.abs(b)?(g=b,f=e/4):f=e/(2*Math.PI)*Math.asin(b/g);return 1>a?-0.5*g*Math.pow(2,10*(a-=1))*Math.sin((a*c-
f)*2*Math.PI/e)+d:0.5*g*Math.pow(2,-10*(a-=1))*Math.sin((a*c-f)*2*Math.PI/e)+b+d},easeInBack:function(a,d,b,c,f){void 0==f&&(f=1.70158);return b*(a/=c)*a*((f+1)*a-f)+d},easeOutBack:function(a,d,b,c,f){void 0==f&&(f=1.70158);return b*((a=a/c-1)*a*((f+1)*a+f)+1)+d},easeInOutBack:function(a,d,b,c,f){void 0==f&&(f=1.70158);return 1>(a/=c/2)?b/2*a*a*(((f*=1.525)+1)*a-f)+d:b/2*((a-=2)*a*(((f*=1.525)+1)*a+f)+2)+d},easeInBounce:function(a,d,c,f){return c-b.Easing.easeOutBounce(f-a,0,c,f)+d},easeOutBounce:function(a,
d,b,c){return(a/=c)<1/2.75?b*7.5625*a*a+d:a<2/2.75?b*(7.5625*(a-=1.5/2.75)*a+0.75)+d:a<2.5/2.75?b*(7.5625*(a-=2.25/2.75)*a+0.9375)+d:b*(7.5625*(a-=2.625/2.75)*a+0.984375)+d},easeInOutBounce:function(a,d,c,f){return a<f/2?0.5*b.Easing.easeInBounce(2*a,0,c,f)+d:0.5*b.Easing.easeOutBounce(2*a-f,0,c,f)+0.5*c+d}};var a=function(a,d){cavy.EventDispatcher.apply(this);this.sprite=a;this.autoRelease=d;this.__attach__=[];this.index=0;this.isReset=this.reverse=this.isRepeat=this.isPlaying=!1;this.time=0;this.stepCallback=
null;var b=this;this._loopHandler=function(){b.update()}};a.prototype=Object.create(cavy.EventDispatcher.prototype);a.prototype.constructor=a;a.prototype.to=function(a){var b=Array.prototype.slice.apply(arguments);a=b.shift();b=new d(a,b);this.__attach__.push(b);this.isPlaying||(b.initialize(this.sprite),this.play());return this};a.prototype.set=function(a){a=new f(a);this.__attach__.push(a);this.isPlaying||(a.initialize(this.sprite),this.play());return this};a.prototype.wait=function(a){a=new g(a);
this.__attach__.push(a);this.isPlaying||(a.initialize(),this.play());return this};a.prototype.call=function(a){a=new e(a);this.__attach__.push(a);this.isPlaying||(a.initialize(),this.play());return this};a.prototype.complete=function(a){var d=function(){this.removeEventListener("complete",d);a.apply(this,[arguments])};this.addEventListener("complete",d);return this};a.prototype.repeat=function(a,d){this.isRepeat=!0;if("number"===typeof a)return this.isReset=!1,this.limit=2*a,this;this.isReset=a||
!1;"number"===typeof d&&(this.limit=d,this.isReset||(this.limit*=2));return this};a.prototype._doAttach=function(){this.reverse?--this.index:++this.index;this.__attach__[this.index].initialize(this.sprite,this.reverse,this.isReset);this.time=Date.now()};a.prototype._hasAttach=function(){var a=this.__attach__.length;if(0===a)return!1;if(this.reverse){if(0!==this.index)return!0}else if(this.index!==a-1)return!0;return!1};a.prototype.play=function(){this.isPlaying||(this.time=Date.now(),this.isPlaying=
!0,this.timer=cavy.Timer.repeat(this._loopHandler));return this};a.prototype.stop=function(){this.isPlaying=!1;this.timer&&this.timer.stop();return this};a.prototype.reset=function(){this.stop();this.index=0;this.isRepeat=this.isReset=!1;this.__attach__=[];return this};a.prototype.update=function(){if(this.sprite&&this.sprite.parent){var a=this.__attach__[this.index];if(cavy.strict){var d=(Date.now()-this.time)/a.time*a.frame;d-a.count>cavy.maxSkip&&(d=a.count+cavy.maxSkip);a.count=Math.min(~~d,a.frame)}d=
b.Easing[a.easing];if(a.count===a.frame){for(var c in a.end)this.sprite[c]=a.end[c];if(this._hasAttach())this._doAttach();else if(this.isRepeat){if(!isNaN(this.limit)&&(--this.limit,0>=this.limit)){this.stop();this.dispatchEvent("complete",this,this.sprite);this.limit=null;return}this.isReset?this.index=-1:this.reverse?(this.reverse=!1,this.index=-1):(this.reverse=!0,this.index=this.__attach__.length);this._doAttach()}else{this.stop();this.dispatchEvent("complete",this,this.sprite);this.autoRelease&&
this.destroy();return}}else if("tween"===a.QUEUE_TYPE){for(c in a.end){var f=a.start[c];this.sprite[c]=d(a.count,f,a.end[c]-f,a.frame-1)}cavy.strict&&a.count++}else"wait"===a.QUEUE_TYPE&&cavy.strict&&a.count++;this.stepCallback&&this.stepCallback.apply(this)}else this.stop()};a.prototype.destroy=function(){this.stop();this.__attach__=[];this.sprite=null};a.prototype.step=function(a){this.stepCallback=a;return this};var d=function(a,d){this.setting={duration:b.duration,easing:b.easing};this.start=
null;this.end=a;if(d)for(var c=d.length;c--;){var f=d[c];if("object"===typeof f)for(var e in f)this.setting[e]=f[e];else"string"===typeof f?this.setting.easing=f:"number"===typeof f&&(this.setting.duration=f)}this.SECOND=1E3;this.time=this.setting.duration;this.easing=this.setting.easing;this.count=0;this.frame=Math.round(this.time/(this.SECOND/cavy.frameRate))};d.prototype={constructor:d,QUEUE_TYPE:"tween",initialize:function(a,d,b){this.count=0;d?(a=this.start,this.start=this.end,this.end=a):this.start&&
!b?(a=this.start,this.start=this.end,this.end=a):(this.start=this.extend(this.end,a),this.checkRelative(this.end))},checkRelative:function(a){for(var d in a){var b=a[d];"string"===typeof b&&-1!==b.search(/\+=|-=/)&&(b=parseFloat(b.replace(/=/,"")),a[d]=b+this.start[d])}},extend:function(a,d){var b={},c;for(c in a)b[c]=d[c];return b}};var f=function(a){this.param=a;this.count=this.frame=0};f.prototype={constructor:f,QUEUE_TYPE:"param",initialize:function(a,d){this.count=this.frame=0;for(var b in this.param)a[b]=
this.param[b]}};var e=function(a){this.callback=a;this.count=this.frame=0};e.prototype={constructor:e,QUEUE_TYPE:"call",initialize:function(a,d){this.count=this.frame=0;this.callback.apply(a)}};var g=function(a){this.time=a;this.count=0;this.SECOND=1E3};g.prototype={constructor:g,QUEUE_TYPE:"wait",initialize:function(){this.count=0;this.frame=Math.round(this.time/(this.SECOND/cavy.frameRate))}};cavy.Tween=new b;cavy.TweenObject=a})(window);(function(c){c.cavy=c.cavy||{};var b=function(a){this.scenes=[];this.scenesData={};this.index=-1;var d=this;this.addHandler=function(a,b){d.add(a,b)};this.removeHandler=function(a){d.remove(param)};this.goHandler=function(a,b){d.go(a,b)};this.selectHandler=function(a,b){d.select(a,b)};this.nextHandler=function(a){d.next(a)};this.prevHandler=function(a){d.prev(a)};this.destroyHandler=function(){d.destroy()};this._initialize(a);return{add:this.addHandler,remove:this.removeHandler,go:this.goHandler,
select:this.selectHandler,next:this.nextHandler,prev:this.prevHandler,destroy:this.destroyHandler}};b.prototype={constructor:b,_initialize:function(a){if(a)for(var d in a)this.add(d,a[d])},add:function(a,d){this.scenes.push(a);this.scenesData[a]=d},remove:function(a){delete this.scenes[a]},go:function(a,d){if("string"===typeof a){var b=this.scenesData[a];b?(this.index=this.scenes.indexOf(a),b(d,this.index)):c.error("Not found: Scene ["+a+"]")}else this.select(a,d)},select:function(a,d){var b=this.scenes[a];
b&&(this.index=a,this.scenesData[b](d,a))},next:function(a){var d=this.index+1,b=this.scenes[d];b&&(this.index=d,this.scenesData[b](a,d))},prev:function(a){var d=this.index-1,b=this.scenes[d];b&&(this.index=d,this.scenesData[b](a,d))},destroy:function(){this.scenes=[];this.scenesData={};this.index=-1}};cavy.Scene=b})(window);(function(c){c.cavy=c.cavy||{};var b=function(d,b){cavy.EventDispatcher.apply(this);this.source=d;if("string"===typeof this.source){var c=new Image;c.src=this.source;this.source=c}this.parent=null;this.width=this.source?this.source.width:0;this.height=this.source?this.source.height:0;this.fitImage=!1;this.fitType="normal";this.positionY=this.positionX=this.offsetY=this.offsetX=this.y=this.x=0;this.scaleY=this.scaleX=1;this.originY=this.originX=0;this.opacity=1;this.skewY=this.skewX=this.rotation=
0;this.visible=!0;this.filter=null;this.children=[];this.matrix=new cavy.Matrix2D;this.mask=null;this.interactive=!0;this.imageCache=this.cache=null;this._visible=!0;this._param=new a;b&&"object"===typeof b&&this.set(b)};b.prototype=Object.create(cavy.EventDispatcher.prototype);b.prototype.constructor=b;b.prototype.set=function(a){for(var b in a)this[b]=a[b];return this};b.prototype.addTo=function(a){a.addChild(this);return this};b.prototype.removeFrom=function(a){a.removeChild(this);return this};
b.prototype.addChild=function(a){a.parent=this;this.children.push(a);return this};b.prototype.addChildAt=function(a,b){a.parent&&a.parent.removeChild(a);if(b>this.children.length)return c.console.error("INDEX_ERROR"),this;a.parent=this;this.children.splice(b,0,a);return this};b.prototype.replaceChild=function(a,b){a.parent&&a.parent.removeChild(a);if(b>this.children.length)return c.console.error("INDEX_ERROR"),this;a.parent=this;this.children[b]=a;return this};b.prototype.swapChild=function(a,b){var c=
this.children.indexOf(a),g=this.children.indexOf(b);this.swapChildAt(c,g);return this};b.prototype.swapChildAt=function(a,b){if(-1!==a&&-1!==b){var c=this.children[a];this.children[a]=b;this.children[b]=c}return this};b.prototype.setIndex=function(a){if(!this.parent)return this;this.parent.setChildIndex(this,a);return this};b.prototype.setChildIndex=function(a,b){if(b>this.children.length)return c.console.error("INDEX_ERROR"),this;var e=this.children.indexOf(a);-1!==e&&(this.children.splice(e,1),
this.children.splice(b,0,a));return this};b.prototype.removeChild=function(a){var b=this.children.indexOf(a);-1!==b&&this.children.splice(b,1);a.parent=null;return this};b.prototype.removeChildAt=function(a){this.children.splice(a,1);return this};b.prototype.removeAllChildren=function(){for(var a=this.children.length;a--;)this.removeChild(this.children[a]);this.children=[];return this};b.prototype.adjustSource=function(a){"width"===a?this.height=this.source.height*this.width/this.source.width:this.width=
this.source.width*this.height/this.source.height};b.prototype.update=function(){this._param.initialize(this);this.fitImage&&this.source&&(this._param.fitSource(this.source,this.fitType),"contain"===this.fitType&&(this.width=this._param.width,this.height=this._param.height));return this._param};b.prototype.getStage=function(){return this instanceof cavy.Stage?this:this.parent?this.parent.getStage():null};b.prototype.clone=function(){var a=new this.constructor;return a=function e(a,b){if(!a)return b;
for(var d=Object.getOwnPropertyNames(b),c=0,n=d.length;c<n;c++){var l=d[c];b.hasOwnProperty(l)&&(b[l]&&"object"===typeof b[l]?a[l]=e(a[l],b[l]):Object.defineProperty(a,l,Object.getOwnPropertyDescriptor(b,l)))}return a}(a,this)};b.prototype.getBoundingRect=function(){this.update();var a=this.getBounds();return this.convertBoundaryRect(a)};b.prototype.getBounds=function(){var a=this.width,b=this.height,c=this.matrix,g={top:c.e,left:c.f,right:c.e+a,bottom:c.f+b,width:a,height:b};if(!this.parent)return g;
var g=(new cavy.Matrix2D).translate(a,0).prependMatrix(c),h=(new cavy.Matrix2D).translate(0,b).prependMatrix(c),a=(new cavy.Matrix2D).translate(a,b).prependMatrix(c);return[[c.e,c.f],[g.e,g.f],[h.e,h.f],[a.e,a.f]]};b.prototype.convertBoundaryRect=function(a){for(var b=a[0][0],c=a[0][0],g=a[0][1],h=a[0][1],k=a.length;k--;)b=Math.min(b,a[k][0]),c=Math.max(c,a[k][0]),g=Math.min(g,a[k][1]),h=Math.max(h,a[k][1]);return{left:b,right:c,top:g,bottom:h,width:c-b,height:h-g}};b.prototype.createCache=function(a){var b=
this.cache||document.createElement("canvas"),c=b.getContext("2d");this.clearCanvas(c,b.width,b.height);b.width=this.width;b.height=this.height;this.update();this._drawCache([this],c);this.cache=b;a&&(this.imageCache=this.imageCache||new Image,this.imageCache.src=b.toDataURL(),"data:,"!==this.imageCache.src&&this.clearCanvas(c,b.width,b.height))};b.prototype.clearCanvas=function(a,b,c){b=b+255>>8;for(c=c+255>>8;b--;)for(var g=0;g<c;g++)a.clearRect(b<<8,g<<8,256,256)};b.prototype._drawCache=function(a,
b){if(a)for(var c=a.slice(),g=0,h=c.length;g<h;g++){var k=c[g];if(k.visible){var m=this.getBoundingRect();b.setTransform(1,0,0,1,-m.left,-m.top);k.draw(b);0===k.children.length||k.cache||this._drawCache(k.children,b)}}};b.prototype.deleteCache=function(){this.imageCache=null;if(this.cache){var a=this.cache.getContext("2d");this.clearCanvas(a,this.cache.width,this.cache.height)}this.cache=null};b.prototype.updateContext=function(a){if(this.parent){var b=this.matrix,c=this.mask||this.parent.mask;c&&
(a.translate(b.e,b.f),c.draw(a,!0),a.clip());this.filter&&(a.globalCompositeOperation=this.filter);1!==b.opacity&&(a.globalAlpha=b.opacity);a.transform(b.a,b.b,b.c,b.d,b.e,b.f)}};var a=function(){this.innerHeight=this.innerWidth=this.sy=this.sx=this.height=this.width=this.y=this.x=0;this.visible=!1};a.prototype={initialize:function(a){this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height;this.innerWidth=a.width;this.innerHeight=a.height;this.visible=a.visible;this.sx=a.offsetX*this.width+
a.positionX;this.sy=a.offsetY*this.width+a.positionY;cavy.pixelSnap&&this.pixelSnap();this.setMatrix(a)},pixelSnap:function(){this.x=0.5+this.x|0;this.y=0.5+this.y|0;this.sx=0.5+this.sx|0;this.sy=0.5+this.sy|0},fitSource:function(a,b){this.innerWidth=a.width;this.innerHeight=a.height;switch(b){case "height":this.width=this.innerWidth*(this.height/this.innerHeight);break;case "width":this.height=this.innerHeight*(this.width/this.innerWidth);break;case "cover":case "contain":var c=this.getResizeData(this.innerWidth,
this.innerHeight,"cover"===b);this.width=c.width;this.height=c.height}},setMatrix:function(a){a.matrix.identity().appendMatrix(a.parent.matrix).appendTransform(this.x,this.y,a.scaleX,a.scaleY,a.rotation,a.skewX,a.skewY,this.width*a.originX,this.height*a.originY);a.matrix.opacity*=a.opacity},getResizeData:function(a,b,c){var g=this.width,h=this.height,k={width:a,height:b};a=g/a;b=h/b;c?a>b?(k.width=g,k.height*=a):(k.height=h,k.width*=b):a<b?(k.width=g,k.height*=a):(k.height=h,k.width*=b);return k}};
cavy.DisplayObject=b})(window);(function(c){c.cavy=c.cavy||{};c=function(b,a){cavy.DisplayObject.apply(this,[b,a])};c.prototype=Object.create(cavy.DisplayObject.prototype);c.prototype.constructor=c;c.prototype.hitTest=function(b,a){var d=this.mask?this.mask.getBoundingRect():this.getBoundingRect();return b>=d.left&&b<=d.right&&a>=d.top&&a<=d.bottom?!0:!1};c.prototype.hitTestObject=function(b){var a=this.getBoundingRect(),d=b.getBoundingRect();this.mask&&!detail&&(a=this.mask.getBoundingRect());b.mask&&!detail&&(d=this.mask.getBoundingRect());
return a.left<=d.right&&a.left<=d.top&&a.right>=d.left&&a.bottom>=d.bottom};cavy.InteractiveObject=c})(window);(function(c){c.cavy=c.cavy||{};var b=function(a,b,c,e,g){this.container=a;"string"===typeof this.container&&(this.container=document.getElementById(this.container));if(null!==this.container){this.canvas=this.container instanceof HTMLCanvasElement?this.container:null;this.tick=this.rendering=this.context=null;this.interactive=e?!0:!1;this.strictEvent=g?!0:!1;var h=this;this._loopHandler=function(a){h.update(a)};this._triggerHandler=function(a){h._triggerEvent(a)};this._initialize(b,c)}};b.prototype=
Object.create(cavy.InteractiveObject.prototype);b.prototype.constructor=b;b.prototype._initialize=function(a,b){cavy.autoRetina?1!==c.devicePixelRatio?(cavy.retina=!0,cavy.deviceRatio=c.devicePixelRatio):cavy.retina=!1:cavy.retina&&(cavy.deviceRatio=2);this.width=a||320;this.height=b||240;cavy.retina&&(this.width*=cavy.deviceRatio,this.height*=cavy.deviceRatio);var f=!0;this.canvas?this.container=this.canvas.parentNode:(this.canvas=document.createElement("canvas"),f=!1);this.container.style.overflow=
"hidden";this.container.style.webkitTapHighlightColor="rgba(0,0,0,0)";this.container.style.tapHighlightColor="rgba(0,0,0,0)";var e=this.canvas.style;!e.backgroundColor&&cavy.isBuggyDevice("background")&&(e.backgroundColor=cavy.backgroundColor);this.canvas.width=this.width;this.canvas.height=this.height;this.context=this.canvas.getContext("2d");cavy.retina&&(e.width=this.width/cavy.deviceRatio+"px",e.height=this.height/cavy.deviceRatio+"px",this.context.scale(cavy.deviceRatio,cavy.deviceRatio));this.interactive&&
(this.canvas.addEventListener("touchstart",this._triggerHandler),this.canvas.addEventListener("touchmove",this._triggerHandler),this.canvas.addEventListener("touchend",this._triggerHandler),this.canvas.addEventListener("gesturestart",this._triggerHandler),this.canvas.addEventListener("gesturechange",this._triggerHandler),this.canvas.addEventListener("gestureend",this._triggerHandler),this.canvas.addEventListener("click",this._triggerHandler));!1===f&&this.container.appendChild(this.canvas);cavy.InteractiveObject.apply(this,
[this.canvas]);this.clear()};b.prototype.clear=function(){this.context&&this.clearCanvas(this.context,this.canvas.width,this.canvas.height)};b.prototype.startRender=function(a){this.stopRender();this.tick=a;this.update();this.rendering=cavy.Timer.repeat(this._loopHandler)};b.prototype.stopRender=function(){this.rendering&&this.rendering.stop();this.rendering=this.tick=null};b.prototype.render=function(a){this.context.save();a.draw(this.context);this.context.restore()};b.prototype.update=function(a){this.tick&&
this.tick(a);this.clear();this._render(this.children)};b.prototype.destroy=function(){this.children=[];this.interactive&&(this.canvas.removeEventListener("touchstart",this._triggerHandler),this.canvas.removeEventListener("touchmove",this._triggerHandler),this.canvas.removeEventListener("touchend",this._triggerHandler),this.canvas.removeEventListener("gesturestart",this._triggerHandler),this.canvas.removeEventListener("gesturechange",this._triggerHandler),this.canvas.removeEventListener("gestureend",
this._triggerHandler),this.canvas.removeEventListener("click",this._triggerHandler));this.clear();this.container.removeChild(this.canvas);this.container=this.context=this.canvas=null};b.prototype._render=function(a){a=a.slice(0);for(var b=0,c=a.length;b<c;b++){var e=a[b];if(!cavy.outOfRendering){var g=e.getBoundingRect(),h=this.width/2,k=this.height/2;if(g.bottom<-k||g.right<-h||g.top>this.height+k||g.left>this.width+h){e._visible=!1;continue}else e._visible=!0}e.visible&&(this.render(e),0===e.children.length||
e.cache||this._render(e.children))}};b.prototype._triggerEvent=function(a){var b=a.touches,c=a.changedTouches,e=this.canvas.getBoundingClientRect(),g=b&&b[0]?b[0].pageX:a.pageX,b=b&&b[0]?b[0].pageY:a.pageY;!g&&c&&(g=c[0].pageX);!b&&a.changedTouches&&(b=c[0].pageY);this._trigger(a,g-e.left,b-e.top,this.children);this.hasEvent(a.type)&&this.dispatchEvent(a.type,a)};b.prototype._trigger=function(a,b,c,e){if(e){e=e.slice();for(var g=e.length;g--;){var h=e[g];if(h&&(0!==h.children.length&&this._trigger(a,
b,c,h.children),h.visible&&(h._visible&&h.hasEvent(a.type)&&h.hitTest(b,c,this.strictEvent))&&(h.dispatchEvent(a.type,a),!1===a.returnValue)))break}}};cavy.Stage=b})(window);(function(c){c.cavy=c.cavy||{};var b=function(a,b){this.backgroundColor="transparent";this.borderWidth=null;this.borderColor="transparent";this.backgroundRepeat=this.backgroundImage=null;this.maskType="relative";this.queue=[];cavy.InteractiveObject.apply(this,[a,b])};b.prototype=Object.create(cavy.InteractiveObject.prototype);b.DEG_TO_RAD=Math.PI/180;b.prototype.constructor=b;b.prototype.drawPath=function(a,b,c){if(this.cache)this.imageCache&&"data:,"!==this.imageCache.src?a.drawImage(this.imageCache,
0,0,this.imageCache.width,this.imageCache.height):a.drawImage(this.cache,0,0,this.cache.width,this.cache.height);else{a.beginPath();b&&c&&(this.backgroundImage?(b=a.createPattern(this.backgroundImage,this.backgroundRepeat),a.fillStyle=b):a.fillStyle="object"===typeof this.backgroundColor?this.backgroundColor.draw(a,b,c):this.backgroundColor);b=0;for(c=this.queue.length;b<c;b++){var e=this.queue[b];a[e[0]].apply(a,e[1])}a.lineWidth=this.borderWidth;a.strokeStyle=this.borderColor;a.stroke();a.fill();
a.closePath()}};b.prototype.rect=function(a,b,c,e){this.queue.push(["rect",[a,b,c,e]])};b.prototype.fillRect=function(a,b,c,e){this.queue.push(["fillRect",[a,b,c,e]])};b.prototype.strokeRect=function(a,b,c,e){this.queue.push(["strokeRect",[a,b,c,e]])};b.prototype.clear=function(){this.queue=[]};b.prototype.clearRect=function(a,b,c,e){this.queue.push(["clearRect",[a,b,c,e]])};b.prototype.lineTo=function(a,b){this.queue.push(["lineTo",[a,b]])};b.prototype.arcTo=function(a,b,c,e,g){this.queue.push(["arcTo",
[a,b,c,e,g]])};b.prototype.bezierCurveTo=function(a,b,c,e,g,h){this.queue.push(["bezierCurveTo",[a,b,c,e,g,h]])};b.prototype.moveTo=function(a,b){this.queue.push(["moveTo",[a,b]])};b.prototype.fan=function(a,c,f,e,g){this.moveTo(a,c);this.queue.push(["arc",[a,c,f,(e-90)*b.DEG_TO_RAD,(e-90+g)*b.DEG_TO_RAD,!1]])};b.prototype.arc=function(a,c,f,e,g,h){e*=b.DEG_TO_RAD;g*=b.DEG_TO_RAD;this.queue.push(["arc",[a,c,f,e,g,h]])};cavy.Graphic=b})(window);(function(c){c.cavy=c.cavy||{};c=function(){};c.prototype.constructor=c;c.prototype.draw=function(){return"transparent"};cavy.BackgroundColor=c})(window);(function(c){c.cavy=c.cavy||{};c=function(b,a){this.y=this.x=0;this.width=b||null;this.height=a||null;this.steps=[]};c.prototype=Object.create(cavy.BackgroundColor.prototype);c.prototype.constructor=c;c.prototype.addStep=function(b,a){this.steps.push([b,a])};c.prototype.draw=function(b){b=b.createLinearGradient(this.x||0,this.y||0,this.width||0,this.height||0);for(var a=this.steps.length,c=0;c<a;c++){var f=this.steps[c];b.addColorStop(f[0],f[1])}return b};cavy.LinearGradient=c})(window);(function(c){c.cavy=c.cavy||{};c=function(b,a,c,f,e,g){this.x0=b||0;this.y0=a||0;this.x1=b||0;this.y1=a||0;this.r0=c||0;this.r1=g||0;this.steps=[]};c.prototype=Object.create(cavy.BackgroundColor.prototype);c.prototype.constructor=c;c.prototype.addStep=function(b,a){this.steps.push([b,a])};c.prototype.draw=function(b,a,c){b=b.createRadialGradient(this.x0+a.width/2,this.y0+a.height/2,this.r0,this.x1+a.width/2,this.y1+a.height/2,this.r1);a=this.steps.length;for(c=0;c<a;c++){var f=this.steps[c];b.addColorStop(f[0],
f[1])}return b};cavy.CircleGradient=c})(window);(function(c){c.cavy=c.cavy||{};c=function(b,a,c){cavy.Graphic.apply(this,[{width:b,height:a},c])};c.prototype=Object.create(cavy.Graphic.prototype);c.prototype.constructor=c;c.prototype.draw=function(b){if(this.parent){var a=this.update(),c=this.matrix;this.updateContext(b);this.drawPath(b,a,c)}};cavy.Shape=c})(window);(function(c){c.cavy=c.cavy||{};c=function(b,a,c){cavy.Graphic.apply(this,[{width:b,height:a},c])};c.prototype=Object.create(cavy.Graphic.prototype);c.prototype.constructor=c;c.prototype.draw=function(b,a){if(this.parent){var c=this.update(),f=this.matrix;a&&"relative"===this.maskType||this.updateContext(b);this.rect(0,0,c.innerWidth,c.innerHeight);this.drawPath(b,c,f);this.queue=[]}};cavy.Rectangle=c})(window);(function(c){c.cavy=c.cavy||{};c=function(b,a,c,f,e){this.radius=b||100;this.startAngle=a||0;this.endAngle=c||360;this.anticlockwise=this.anticlockwise||!1;cavy.Graphic.apply(this,[{width:2*b,height:2*b},e])};c.prototype=Object.create(cavy.Graphic.prototype);c.prototype.constructor=c;c.prototype.draw=function(b){if(this.parent){var a=this.update(),c=this.matrix;this.updateContext(b);this.arc(a.sx+this.radius,a.sy+this.radius,this.radius,this.startAngle,this.endAngle,this.anticlockwise);this.drawPath(b,
a,c);this.queue=[]}};cavy.Circle=c})(window);(function(c){c.cavy=c.cavy||{};c=function(b,a){cavy.InteractiveObject.apply(this,[b,a])};c.prototype=Object.create(cavy.InteractiveObject.prototype);c.prototype.constructor=c;c.prototype.draw=function(b){if(this.parent){var a=this.update();this.updateContext(b);this.cache?this.imageCache&&"data:,"!==this.imageCache.src?b.drawImage(this.imageCache,0,0,this.imageCache.width,this.imageCache.height):b.drawImage(this.cache,0,0,this.cache.width,this.cache.height):this.source&&(a.sx+a.innerWidth>this.source.width&&
(a.width=this.source.width,a.innerWidth=this.source.width),a.sy+a.innerHeight>this.source.height&&(a.height=this.source.height,a.innerHeight=this.source.height),b.drawImage(this.source,a.sx,a.sy,a.innerWidth,a.innerHeight,0,0,a.width,a.height))}};cavy.Sprite=c})(window);(function(c){c.cavy=c.cavy||{};c=function(b,a,c){this.pattern=a||[];this.sheet=null;this.interval=this.count=this.frame=0;this.direction="horizontal";this.timer=null;this.line=0;var f=this;this._enterframeHandler=function(){f.enterframe()};cavy.Sprite.apply(this,[b,c])};c.prototype=Object.create(cavy.Sprite.prototype);c.prototype.constructor=c;c.prototype.play=function(){this.timer=cavy.Timer.repeat(this._enterframeHandler,this.interval)};c.prototype.stop=function(){cavy.Timer.stop(this.timer)};c.prototype.enterframe=
function(b){var a=this.pattern[this.sheet];if(a){b=a[0];var c=a[1],f=a[3];this.frame>a[2]&&(f&&(++this.count,this.count===f&&(this.stop(),this.dispatchEvent("complete"))),this.frame=this.line=0);a=0;"horizontal"===this.direction?(b=Math.floor(this.source.width/this.width),a=0===this.line?this.frame:this.frame-this.line*b,a===b?(this.offsetX=0,this.line+=1):this.offsetX=a,this.offsetY=this.line+c):(c=Math.floor(this.source.height/this.height),a=0===this.line?this.frame:this.frame-this.line*c,a===c?
(this.offsetY=0,this.line+=1):this.offsetY=a,this.offsetX=this.line+b);this.frame++}};cavy.SpriteSheet=c})(window);(function(c){c.cavy=c.cavy||{};c=function(b,a,c,f){this.text=b;"object"===typeof a?f=a:a&&c&&(f=f||{},f.width=a,f.height=c);this.fontSize="14px";this.fontFamily="Arial";this.bold=!1;this.color="#000";this.textAlign="left";this.textBaseline="alphabetic";this.lineHeight=1.5;this.shadow=!1;this.shadowColor="#333";this.shadowBlur=this.shadowY=this.shadowX=0;this.autoResize=this.hasTextCache=this.outline=!1;this.autoCache=!0;this._sizeCache=document.createElement("canvas");this._sizeContext=this._sizeCache.getContext("2d");
this._paramCache={};this._reloadParams="fontSize fontFamily textBaseline lineHeight text bold width height".split(" ");cavy.InteractiveObject.apply(this,[null,f])};c.prototype=Object.create(cavy.InteractiveObject.prototype);c.prototype.constructor=c;c.prototype.reDraw=function(){this.hasTextCache=!1};c.prototype.draw=function(b){if(this.text&&this.parent){var a=0,c=null;if(this.hasTextCache)for(a=this._reloadParams.length;a--;)if(c=this._reloadParams[a],this._paramCache[c]!==this[c]){this.hasTextCache=
!1;break}if(this.hasTextCache)this.drawCache(b);else{this.source={width:this.width,height:this.height};this.drawText();this.drawCache(b);for(a=this._reloadParams.length;a--;)c=this._reloadParams[a],this._paramCache[c]=this[c];this.hasTextCache=!0}}};c.prototype.drawCache=function(b){var a=this.update();this.updateContext(b);this.imageCache&&"data:,"!==this.imageCache.src?b.drawImage(this.imageCache,0,0,a.width,a.height):b.drawImage(this.cache,0,0,a.width,a.height)};c.prototype.drawText=function(){var b=
this.cache||document.createElement("canvas"),a=b.getContext("2d"),c=0,f=[this.bold?"bold":"",this.parseFontSize(this.fontSize),"'"+this.fontFamily+"'"];this._sizeContext.font=f.join(" ");var e=cavy.retina?2*this.width:this.width,g=cavy.retina?2*this.height:this.height,h=String(this.text),k=this._sizeContext.measureText("\uff2d").width,h=h.split("\n"),m=h.length,n=k*this.lineHeight;if(this.autoResize||0===e&&0===g){for(var l=0;l<m;l++){var p=this._sizeContext.measureText(h[l]).width;e<p&&(e=p)}g<n&&
(g=n*m)}this.clearCanvas(a,b.width,b.height);b.width=e;b.height=g;this.width=e/cavy.deviceRatio;this.height=g/cavy.deviceRatio;a.font=f.join(" ");this.shadow&&(a.shadowColor=this.shadowColor,a.shadowOffsetX=this.shadowX,a.shadowOffsetY=this.shadowY,a.shadowBlur=this.shadowBlur);switch(this.textAlign){case "center":c=b.width/2;break;case "right":c=b.width}a.textAlign=this.textAlign;a.textBaseline=this.textBaseline;this.outline?a.strokeStyle=this.color:a.fillStyle=this.color;for(l=0;l<m;l++)f=h[l],
this.outline?a.strokeText(f,c,k+l*n):a.fillText(f,c,k+l*n);this.cache=b;this.autoCache&&(this.imageCache=this.imageCache||new Image,this.imageCache.src=b.toDataURL())};c.prototype.parseFontSize=function(b){var a=String(b).match(/mm|cm|in|pt|pc|em|ex|px|%/);a||(a=null);b=parseFloat(String(b).replace(a,""));isNaN(b)&&(b=0);cavy.retina&&(b*=2);return b+a};cavy.Text=c;cavy.TextObject=c})(window);
